# Atlassian 的两年云之旅 

> 原文：<https://web.archive.org/web/https://techcrunch.com/2018/04/02/atlassians-two-year-cloud-journey/>

几年前，Dropbox 决定放弃公共云，而[建立了自己的数据中心](https://web.archive.org/web/20230214192201/https://techcrunch.com/2017/09/15/why-dropbox-decided-to-drop-aws-and-build-its-own-infrastructure-and-network/)，这震惊了很多人。最近， [Atlassian](https://web.archive.org/web/20230214192201/https://www.atlassian.com/) 反其道而行之，关闭了大部分数据中心，转向云计算。公司出于各种原因做出这些选择。当 Atlassian 的 CTO Sri Viswanath 在 2016 年加入公司时，他决定将公司最大的应用程序转移到 AWS。

在某种程度上，这是一个技术债务的故事——这是一个概念，随着时间的推移，你的应用程序会被一层又一层的代码所拖累，使得更新变得更加困难，维护变得更加困难。对于成立于 2002 年的 Atlassian 来说，该账单应于 2016 年维斯瓦纳特来该公司工作时到期。

Atlassian 已经知道他们需要更新代码来进入未来。他们把维斯瓦纳带到船上的原因之一是领导那次冲锋，但是这种想法甚至在他到达那里之前就已经存在了。早在 2015 年就成立了一个小型团队来制定新的基于云的方法的愿景和架构，但他们希望有第一位 CTO 来完成这项工作。

## 转向微服务

他将该计划付诸实施，给它起了一个内部代号*Vertigo*——也许是因为将他们的大部分软件堆栈迁移到公共云的想法让工程团队晕头转向，甚至不敢考虑。该项目的目标是重新构建软件，从他们最大的产品吉拉和 Confluence 开始，以这样一种方式为公司未来十年奠定基础——没有压力或任何东西。

![](img/0ec27c168d5e475cd4cbae34171be5fd.png)

图片来源:威廉·韦斯特/法新社/盖蒂图片社

他们花了 2016 年的大部分时间来重写软件，并在 AWS 上安装它。他们专注于将他们 15 年前的代码转变为微服务，这最终导致了更小的代码库。他说，技术性债务问题非常真实，但他们必须小心，不要重新发明轮子，只要有可能，就改变需要改变的。

“代码库相当大，我们必须进去做两件事。我们想为多租户架构打造它，我们想创造微服务，”他说。“如果有一项服务可以被提取出来并成为独立的服务，我们会这样做，但我们也会在流程中创建新的服务。”

## 动态迁移客户

去年是迁移年，将最后一个客户迁移到新系统确实需要一整年的时间。它始于 1 月，止于 12 月，涉及数万名顾客的搬迁。

![](img/fcd0fbcedd3cfebe52a3e3d8da81b4c6.png)

图片:kts design/科学图片库

首先，他们尽可能实现自动化，而且他们在迁移顺序方面也非常谨慎，意识到迁移可能会更加困难。“我们考虑了迁移的顺序。我们不想先做最容易的，最后做最难的。我们不想只做比较难的，而没有进展。我们必须在整个项目中混合(我们的方法)来修复错误和问题，”他说。

Viswanath 表示，首要目标是在不发生重大事故的情况下转移客户。“如果你与任何从事迁移的人交谈，那是一件大事。每个人在迁徙的时候都会有伤疤。我们有意识地非常小心地做这件事。”令人惊讶的是，虽然它并不完美，但他们确实设法完成了整个练习，没有出现大的中断，这是该团队有理由感到自豪的一点。这并不意味着它总是一帆风顺。

“这听起来超级容易:‘我们考虑周到，我们移民了’，但每天都有战争。当你迁移的时候，你会碰壁并做出反应。这是我们一年中每天都要做的事情，”他解释道。这需要整个团队的努力，包括工程、产品和支持。这包括让一个客户支持人员参与每天的 scrum 会议，这样他们就能感觉到客户遇到的任何问题，并尽快解决它们。

## 他们获得了什么

正如在任何云项目中一样，将应用程序迁移到云中有一些关于灵活性、敏捷性和资源弹性的一般好处，但对于这个特定的项目来说，好处还不止这些。

![](img/2ac9f7a8061595dc6820da05cc12160a.png)

图片来源:Ade Akinrujomu/Getty Images

首先，由于微服务的大量使用，它允许同时进行多个部署的更快部署。这意味着他们可以更快地添加新功能。在迁移年期间，他们在很大程度上推迟了新功能的开发，因为他们希望在迁移过程中尽可能保持静态，但是有了新系统，他们可以更快地添加新功能。

他们获得了更好的性能，如果他们遇到性能瓶颈，他们可以添加更多资源，因为这是云。此外，他们能够在欧盟拥有本地业务，并通过让应用程序更靠近位于那里的最终用户来提高性能。

最后，他们实际上发现云是一个更经济的选择，这并不是每个迁移到云的公司都会发现的。通过关闭数据中心并降低与购买硬件和雇佣 IT 人员维护硬件相关的资本成本，他们能够降低成本。

## 管理人员部分

这是一个旷日持久的项目，因此，他们真的需要考虑它的人性方面。他们将交换人员，以确保工程师保持新鲜，而不是耗尽精力来帮助过渡。

有一点很有帮助，那就是公司文化，维斯瓦纳特坦率地将其描述为一种开放的沟通和普遍的“不说废话”的政策。“即使在事情不顺利的时候，我们也保持着开放的沟通。如果有人跟不上，他们会举手，我们会帮助他们，”他说。

他承认，公司内部和他个人对实施如此规模的项目有些焦虑，但他们知道为了公司的未来，他们需要这样做。“如果这个项目进展不顺利，人们肯定会感到紧张。这似乎是显而易见的正确方向，我们必须这样做。风险在于，如果我们在执行过程中搞砸了，并且没有实现我们设定的目标，那该怎么办。”

最后，这是一个很大的工作量，但结果很好，他们已经为未来准备好了系统。“现在我们为未来 10 年做好了准备，”他说。